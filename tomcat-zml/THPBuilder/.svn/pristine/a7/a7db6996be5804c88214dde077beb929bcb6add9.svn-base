webpackJsonp([9],{SZRf:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("BO1k"),r=a.n(i),l=["上海","北京","广州","深圳"],n={data:function(){return{tableheight:500,downloadLoading:!1,valuetime:"",startTime:"",endTime:"",typeData:[],prioritData:[],tableData:[],prioritychecked:{ischecked:!1,viewchecked:!1},checkedType:[],input_object_name:"",input_cobject_name:"",input_content:"",more:!1,viewtableData:[],pagesizes:[50,100,200,500],pagesize:50,totalcount:0,currentpage:1}},mounted:function(){var t=new Date(new Date((new Date).toLocaleDateString()).getTime()),e=new Date(new Date((new Date).toLocaleDateString()).getTime()+864e5-1);this.startTime=t,this.endTime=e,this.get_alarm_priority(),this.get_alarm_type()},methods:{headercellstyle:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return"background:#F7F8FA;font-weight: bold;color: #101010;"},handleCheckAllChange:function(t){this.checkedCities=t?l:[],this.isIndeterminate=!1},handleCheckedCitiesChange:function(t){var e=t.length;this.checkAll=e===this.cities.length,this.isIndeterminate=e>0&&e<this.cities.length},selected:function(){var t,e=this.getcheckedPriority(),a=this.getcheckedTypes(),i=Date.parse(this.startTime)/1e3,r=Date.parse(this.endTime)/1e3,l=[],n=this.input_object_name,c=this.input_cobject_name,s=this.input_content;n&&((t={name:"object_name"}).value=n,l.push(t));c&&((t={name:"cobject_name"}).value=c,l.push(t));s&&((t={name:"content"}).value=s,l.push(t));this.get_data_func(i,r,e,a,l)},selectedPriority:function(t){if(0==t){if(this.prioritychecked.ischecked=!this.prioritychecked.ischecked,this.prioritychecked.viewchecked=!this.prioritychecked.viewchecked,this.prioritychecked.ischecked)for(var e in this.prioritData)this.prioritData[e].viewchecked=!1,this.prioritData[e].ischecked=!0}else{var a=0;for(var i in this.prioritData)t==this.prioritData[i].priority_id&&(this.prioritData[i].viewchecked=!this.prioritData[i].viewchecked),this.prioritData[i].viewchecked&&(this.prioritData[i].ischecked=!0,this.prioritychecked.viewchecked=!1,a++);if(a==this.prioritData.length)for(var e in this.prioritychecked.ischecked=!0,this.prioritychecked.viewchecked=!0,this.prioritData)this.prioritData[e].viewchecked=!1}},selectedType:function(t,e){for(var a in this.typeData)if(this.typeData[a].type_id==t.type_id)if(e){var i=0;for(var r in this.typeData[a].children)e.type_id==this.typeData[a].children[r].type_id&&(this.typeData[a].children[r].viewchecked=!this.typeData[a].children[r].viewchecked),this.typeData[a].children[r].viewchecked&&(this.typeData[a].children[r].ischecked=!0,i++);if(i==this.typeData[a].children.length)for(var r in this.typeData[a].ischecked=!0,this.typeData[a].viewchecked=!0,this.typeData[a].children)this.typeData[a].children[r].viewchecked=!1}else if(this.typeData[a].ischecked=!this.typeData[a].ischecked,this.typeData[a].viewchecked=!this.typeData[a].viewchecked,this.typeData[a].ischecked)for(var r in this.typeData[a].children)this.typeData[a].children[r].ischecked=!0,this.typeData[a].children[r].viewchecked=!1},get_alarm_priority:function(){var t=this;t.$http.get(t.BASE_INFO.ALARM_URL+"/getAlarmPriority").then(function(e){if(e&&e.data&&e.data.result&&e.data.result.data){var a=e.data.result.data,i=[],l=!0,n=!1,c=void 0;try{for(var s,o=r()(a);!(l=(s=o.next()).done);l=!0){var h={};(h=s.value).ischecked=!1,h.viewchecked=!1,i.push(h)}}catch(t){n=!0,c=t}finally{try{!l&&o.return&&o.return()}finally{if(n)throw c}}t.prioritData=i,t.selectedPriority(0)}})},get_alarm_type:function(){var t=this;t.$http.get(t.BASE_INFO.ALARM_URL+"/getAlarmType").then(function(e){if(e&&e.data&&e.data.result&&e.data.result.data){var a=e.data.result.data,i=t.toTree(a,0),l=[],n=!0,c=!1,s=void 0;try{for(var o,h=r()(i);!(n=(o=h.next()).done);n=!0){var p={};(p=o.value).ischecked=!1,p.viewchecked=!1;var d=[],v=!0,u=!1,m=void 0;try{for(var f,_=r()(p.children);!(v=(f=_.next()).done);v=!0){var y=x=f.value;y.ischecked=!1,y.viewchecked=!1,d.push(y)}}catch(t){u=!0,m=t}finally{try{!v&&_.return&&_.return()}finally{if(u)throw m}}l.push(p)}}catch(t){c=!0,s=t}finally{try{!n&&h.return&&h.return()}finally{if(c)throw s}}if(t.typeData=l,l){var g=!0,b=!1,k=void 0;try{for(var w,D=r()(l);!(g=(w=D.next()).done);g=!0){var x=w.value;t.selectedType(x,null)}}catch(t){b=!0,k=t}finally{try{!g&&D.return&&D.return()}finally{if(b)throw k}}}}})},getcheckedPriority:function(){var t=[],e=!0,a=!1,i=void 0;try{for(var l,n=r()(this.prioritData);!(e=(l=n.next()).done);e=!0){var c=l.value;c.ischecked&&t.push(c.priority_id)}}catch(t){a=!0,i=t}finally{try{!e&&n.return&&n.return()}finally{if(a)throw i}}return t},getcheckedTypes:function(){var t=[],e=!0,a=!1,i=void 0;try{for(var l,n=r()(this.typeData);!(e=(l=n.next()).done);e=!0){var c=l.value;if(c.children){var s=!0,o=!1,h=void 0;try{for(var p,d=r()(c.children);!(s=(p=d.next()).done);s=!0){var v=p.value;v.ischecked&&t.push(v.type_id)}}catch(t){o=!0,h=t}finally{try{!s&&d.return&&d.return()}finally{if(o)throw h}}}}}catch(t){a=!0,i=t}finally{try{!e&&n.return&&n.return()}finally{if(a)throw i}}return t},get_data_func:function(t,e,a,i,r){var l=this,n={begintime:t,endtime:e,priority:a,alarm_type:i,filter:r};l.$http.post(l.BASE_INFO.ALARM_URL+"/getDataByFilter",n).then(function(t){if(t&&t.data&&t.data.result&&t.data.result.data){var e=t.data.result.data;l.tableData=e,l.currentpage=1,l.formatTableData()}})},formatTableData:function(){this.totalcount=this.tableData.length;var t=this.currentpage,e=(t-1)*this.pagesize,a=(t-1)*this.pagesize+this.pagesize;this.viewTableData(e,a)},viewTableData:function(t,e){var a=this.tableData,i=[];a.length<e&&(e=a.length);for(var r=t;r<e;r++){var l=a[r];i.push(l)}this.viewtableData=i},toTree:function(t,e){for(var a,i=[],r=0;r<t.length;r++)if(t[r].parent_type_id==e){var l=t[r];(a=this.toTree(t,t[r].type_id)).length>0&&(l.children=a),i.push(l)}return i},toTree1:function(t,e){for(var a=[],i=0;i<t.length;i++){var r=t[i],l=!1;for(var n in a)a[n].floor==r.floor&&(l=!0);if(l)a[n].children.push(r);else{var c={};c.floor=r.floor,c.children=[],c.children.push(r),a.push(c)}}return a},exportToExcel:function(){var t=this;this.tableData.length>0&&(this.downloadLoading=!0,a.e(16).then(function(){var e=a("zWO4").export_json_to_excel,i=t.tableData;e(["编号","主对象编号","告警大类","告警类型","告警原因","告警类型","告警时间","主对象名称","告警区域","告警值","告警级别","告警内容","注释内容","确认人员","确认时间","删除人员","删除时间"],t.formatJson(["alarmid","objectid","categoryname","typename","reasonname","typename","timestamp","objectname","cobjectname","alarmvalue","priorityname","content","note","confirmuser","acktime","deleteuser","deltime"],i),"列表excel"),t.downloadLoading=!1}.bind(null,a)).catch(a.oe))},handleSizeChange:function(t){console.log("每页 "+t+" 条"),this.pagesize=t},handleCurrentChange:function(t){console.log("当前页: "+t),this.currentpage=t,this.formatTableData()}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"divcontent"},[t._m(0),t._v(" "),a("div",{staticClass:"sl-v-list"},[a("span",{staticClass:"sapn-margin-left left title",staticStyle:{"margin-top":"4px"}},[t._v("开始时间：")]),t._v(" "),a("el-date-picker",{staticClass:"left  text-width",staticStyle:{"margin-left":"3px"},attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}}),t._v(" "),a("span",{staticClass:"sapn-margin-left  left title",staticStyle:{"margin-top":"4px"}},[t._v("结束时间：")]),t._v(" "),a("el-date-picker",{staticClass:"left  text-width",attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}}),t._v(" "),a("el-button",{staticClass:"left",staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:t.selected}},[t._v("查询")]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:!t.more,expression:"!more"}],staticClass:"more left",staticStyle:{"margin-left":"8px","margin-top":"4px",color:"#4066F7"},on:{click:function(e){t.more=!0}}},[t._v("更多")])],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.more,expression:"more"}],staticClass:"sl-v-list"},[a("span",{staticClass:"title"},[t._v("主对象名称：")]),t._v(" "),a("el-input",{staticClass:"text-width",attrs:{placeholder:"请输入内容"},model:{value:t.input_object_name,callback:function(e){t.input_object_name=e},expression:"input_object_name"}}),t._v(" "),a("span",{staticClass:"title",staticStyle:{"margin-left":"8px"}},[t._v("告警区域：")]),t._v(" "),a("el-input",{staticClass:"text-width",attrs:{placeholder:"请输入内容"},model:{value:t.input_cobject_name,callback:function(e){t.input_cobject_name=e},expression:"input_cobject_name"}}),t._v(" "),a("span",{staticClass:"title",staticStyle:{"margin-left":"8px"}},[t._v("告警内容：")]),t._v(" "),a("el-input",{staticClass:"text-width",attrs:{placeholder:"请输入内容"},model:{value:t.input_content,callback:function(e){t.input_content=e},expression:"input_content"}}),t._v(" "),a("span",{staticClass:"more",staticStyle:{"margin-left":"10px","margin-top":"4px",color:"#4066F7"},on:{click:function(e){t.more=!1}}},[t._v("收起")])],1),t._v(" "),a("div",{staticClass:"sl-v-list"},[a("span",{staticClass:"left title"},[t._v("告警级别：")]),t._v(" "),a("ul",{staticClass:"left ul_nav"},[a("li",{class:t.prioritychecked.viewchecked?"class-a":"class-b",on:{click:function(e){t.selectedPriority(0)}}},[t._v("全部")]),t._v(" "),t._l(t.prioritData,function(e,i){return a("li",{key:i,class:e.viewchecked?"class-a":"class-b",on:{click:function(a){t.selectedPriority(e.priority_id)}}},[t._v(t._s(e.name))])})],2)]),t._v(" "),t._l(t.typeData,function(e,i){return a("div",{key:i,staticClass:"sl-v-list"},[a("span",{staticClass:"left title"},[t._v(t._s(e.type_name)+"：")]),t._v(" "),a("ul",{staticClass:"left ul_nav"},[a("li",{class:e.viewchecked?"class-a":"class-b",on:{click:function(a){t.selectedType(e,null)}}},[t._v("全部")]),t._v(" "),t._l(e.children,function(i,r){return a("li",{key:r,class:i.viewchecked?"class-a":"class-b",on:{click:function(a){t.selectedType(e,i)}}},[t._v(t._s(i.type_name))])})],2)])}),t._v(" "),a("div",{staticStyle:{float:"right","margin-right":"20px","margin-top":"20px","margin-bottom":"10px"}},[a("el-button",{attrs:{type:"info",plain:"",loading:t.downloadLoading},on:{click:t.exportToExcel}},[t._v("导出数据")])],1),t._v(" "),a("div",{staticClass:"div-table"},[a("el-table",{attrs:{data:t.tableData,"header-cell-style":t.headercellstyle,"max-height":t.tableheight}},[a("el-table-column",{attrs:{prop:"alarmid",width:"150",label:"编号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"objectid",label:"主对象编号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"categoryname",label:"告警大类"}}),t._v(" "),a("el-table-column",{attrs:{prop:"typename",label:"告警类型"}}),t._v(" "),a("el-table-column",{attrs:{prop:"reasonname",label:"告警原因"}}),t._v(" "),a("el-table-column",{attrs:{prop:"timestamp",label:"告警时间",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{prop:"objectname",label:"主对象名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"cobjectname",label:"告警区域"}}),t._v(" "),a("el-table-column",{attrs:{prop:"alarmvalue",label:"告警值"}}),t._v(" "),a("el-table-column",{attrs:{prop:"priorityname",label:"告警级别"}}),t._v(" "),a("el-table-column",{attrs:{prop:"content",label:"告警内容",width:"350"}}),t._v(" "),a("el-table-column",{attrs:{prop:"note",label:"注释内容"}}),t._v(" "),a("el-table-column",{attrs:{prop:"confirmuser",label:"确认人员"}}),t._v(" "),a("el-table-column",{attrs:{prop:"acktime",label:"确认时间"}}),t._v(" "),a("el-table-column",{attrs:{prop:"deleteuser",label:"删除人员"}}),t._v(" "),a("el-table-column",{attrs:{prop:"deltime",label:"删除时间"}})],1),t._v(" "),a("div",{staticClass:"block",staticStyle:{float:"right","margin-top":"20px","margin-bottom":"20px"}},[a("span",{staticClass:"demonstration"}),t._v(" "),a("el-pagination",{attrs:{"current-page":t.currentpage,"page-sizes":t.pagesizes,"page-size":t.pagesize,layout:"total,sizes, prev, pager, next, jumper",total:t.totalcount},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("p",[this._v("查询历史告警")])])}]};var s=a("VU/8")(n,c,!1,function(t){a("eNFw")},"data-v-70005ceb",null);e.default=s.exports},eNFw:function(t,e){}});