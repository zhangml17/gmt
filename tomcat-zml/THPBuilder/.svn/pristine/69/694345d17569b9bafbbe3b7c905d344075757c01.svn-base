webpackJsonp([2],{tJ31:function(e,t){},vvr3:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("BO1k"),i=a.n(l),n={data:function(){return{timeName:"刷新",isrefresh:!1,refreshInterval:{},data2:function(e){var t=[],a=["shanghai","beijing","guangzhou","shenzhen","nanjing","xian","chengdu"];return["上海","北京","广州","深圳","南京","西安","成都"].forEach(function(e,l){t.push({label:e,key:l,pinyin:a[l]})}),t}(),checkvalue:[],addtabs:!1,tableName:"",treeData:[],columns:["A","B","C"],tableData:[[1,2,3],[4,5,6]],viewcolumns:[],viewtableData:[],multipleSelection:[],editableTabsValue:"0",editableTabs:[],tabIndex:0,checkList:[],columnnameoptions:[],columnname:"",symboloptions:[{value:"选项1",label:"黄金糕"}],symbol:"",inputvalue:"",condition:"",inputTime:5,dialogFormVisible:!1,dialogUpdateVisible:!1,form:{columnname:"",columnnameoptions:[],label:"内部ID32",value:"",radio:"",inputstep:"",inputcycle:""},formLabelWidth:"120px",isString:!1,conditionIndex:0,conditionList:[],selcetCount:"30",pagesizes:[50,100,200,500],pagesize:30,totalcount:0,currentpage:1,idArr:[],checkedkeys:[]}},mounted:function(){this.getTreeData()},methods:{headercellstyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;return"background:#E4E7EB;font-weight: bold;color: #101010;"},handleNodeClick:function(e){this.addTab(this.editableTabsValue,e),this.addtabs=!0;var t=[],a=[],l=[];for(var i in e.fields)t.push(e.fields[i].Desc),e.fields[i].key=e.fields[i].Name,e.fields[i].label=e.fields[i].Desc,l.push(e.fields[i]),e.fields[i].value=e.fields[i].Name,a.push(e.fields[i]);this.columns=a,this.columnnameoptions=e.fields,this.checkList=l,this.tableName=e.path,this.initoptions(!1),this.getTableCount();this.getTableData(e.path,this.pagesize,[]),this.form.columnnameoptions=e.fields},getTreeData:function(){var e=this;e.treeData=[],e.idArr=[],e.checkedkeys=[],e.$http.get(e.BASE_INFO.BASE_DATA_URL+"/getModelDef").then(function(t){if(t&&t.data&&t.data.result&&t.data.result.Setting&&t.data.result.Setting.database){var a=t.data.result.Setting.database,l={label:"数据库",id:0,children:[]},n=!0,o=!1,s=void 0;try{for(var r,c=i()(a);!(n=(r=c.next()).done);n=!0){var u=r.value,d={};if((d=u).label=u.Alias,l.id=u.ID32,0==e.idArr.length&&e.idArr.push(l.id),u.table){d.children=[];var h=!0,m=!1,p=void 0;try{for(var v,f=i()(u.table);!(h=(v=f.next()).done);h=!0){var b=v.value,g=b;g.label=b.Alias,g.id=u.ID32,d.children.push(g),0==e.checkedkeys.length&&(e.checkedkeys.push(g.id),e.handleNodeClick(g))}}catch(e){m=!0,p=e}finally{try{!h&&f.return&&f.return()}finally{if(m)throw p}}}l.children.push(d)}}catch(e){o=!0,s=e}finally{try{!n&&c.return&&c.return()}finally{if(o)throw s}}e.treeData.push(l)}})},getTableData:function(e,t,a){var l=this,i=a,n={tbname:e,begin:(l.currentpage-1)*l.pagesize,count:t,filter:a};l.$http.post(l.BASE_INFO.BASE_DATA_URL+"/getRecordByIndexfilter",n).then(function(e){if(e&&e.data&&e.data.result&&e.data.result.data){var t=[],a=e.data.result.data;for(var n in a){var o={},s=a[n].record.split(",");for(var r in s){var c=l.columns[r].value,u=s[r];l.$set(o,c,u)}t.push(o)}l.tableData=t;var d=0,h=l.pagesize;if(i.length>0){l.totalcount=l.tableData.length;var m=l.currentpage;d=(m-1)*l.pagesize,h=(m-1)*l.pagesize+l.pagesize}l.viewCloumns(d,h)}else l.tableData=[]})},getTableCount:function(){var e=this,t={tbname:e.tableName};e.$http.post(e.BASE_INFO.BASE_DATA_URL+"/query_count",t).then(function(t){if(t&&t.data&&t.data.result){var a=parseInt(t.data.result.count);e.totalcount=a,e.currentpage=1}})},initoptions:function(e){var t=[];return e?(t.push({value:"==",label:"等于"}),t.push({value:"contains",label:"包含"}),t.push({value:"not_contains",label:"不包含"}),t.push({value:"begin_with",label:"以…为开头"}),t.push({value:"end_with",label:"以…结束"})):(t.push({value:"==",label:"等于"}),t.push({value:"<>",label:"不等于"}),t.push({value:">",label:"大于"}),t.push({value:"<",label:"小于"}),t.push({value:">=",label:"大于等于"}),t.push({value:"<=",label:"小于等于"})),t},addTab:function(e,t){var a=t.path,l=!1;this.editableTabs.forEach(function(e,t){e.name===a&&(l=!0)}),l||(this.editableTabs.push({title:t.label,name:a,tabname:t.path,content:""}),this.editableTabsValue=a)},removeTab:function(e){var t=this.editableTabs,a=this.editableTabsValue;a===e&&t.forEach(function(l,i){if(l.name===e){var n=t[i+1]||t[i-1];n&&(a=n.name)}}),this.editableTabsValue=a,this.editableTabs=t.filter(function(t){return t.name!==e});this.tableName=a,this.getTableData(a,this.pagesize,[])},onTabClick:function(e){this.editableTabs;if(this.editableTabsValue===e.name){var t=e.name;this.tableName=e.name;this.getTableData(t,this.pagesize,[])}},changeColumnName:function(e){var t=!1;if(this.columnnameoptions){var a=!0,l=!1,n=void 0;try{for(var o,s=i()(this.columnnameoptions);!(a=(o=s.next()).done);a=!0){var r=o.value;r.Name==e&&"STRING"===r.DataType&&(t=!0)}}catch(e){l=!0,n=e}finally{try{!a&&s.return&&s.return()}finally{if(l)throw n}}}this.symboloptions=this.initoptions(t)},changeItemColumnName:function(e,t){if(this.conditionList){var a=this.conditionList[t],l=!1;if(a.columnnameoptions){var n=!0,o=!1,s=void 0;try{for(var r,c=i()(a.columnnameoptions);!(n=(r=c.next()).done);n=!0){var u=r.value;u.Name==e&&"STRING"===u.DataType&&(l=!0)}}catch(e){o=!0,s=e}finally{try{!n&&c.return&&c.return()}finally{if(o)throw s}}}this.conditionList[t].symboloptions=[],this.conditionList[t].symboloptions=this.initoptions(l)}},onselectclick:function(){var e=[],t=this.columnname,a=this.symbol,l=this.inputvalue;if(""!=t||""!=l){var n={};n.name=t,n.value=l,n.method=a,e.push(n)}if(this.conditionList){var o=!0,s=!1,r=void 0;try{for(var c,u=i()(this.conditionList);!(o=(c=u.next()).done);o=!0){var d=c.value;if(""!=t||""!=l){var h={};h.name=d.columnname,h.value=d.inputvalue,h.method=d.symbol,e.push(h)}}}catch(e){s=!0,r=e}finally{try{!o&&u.return&&u.return()}finally{if(s)throw r}}}var m=0;0==e.length&&(m=this.pagesize),this.getTableData(this.tableName,m,e)},addcondition:function(){var e=++this.conditionIndex+"",t={};t.id=e,t.columnname="",t.columnnameoptions=this.columnnameoptions,t.symboloptions=this.symboloptions,t.symbol="",t.inputvalue="",t.condition="",this.conditionList.push(t)},clearcondition:function(){this.conditionList&&(this.conditionList=[])},deletecondition:function(e){this.conditionList&&this.conditionList.splice(e,1)},confirmCloumns:function(){var e=this.currentpage,t=(e-1)*this.pagesize,a=(e-1)*this.pagesize+this.pagesize;this.viewCloumns(t,a),this.dialogFormVisible=!1},viewCloumns:function(e,t){var a=this.checkvalue,l=this.columns,n=this.tableData;if(a.length>0){var o=[],s=!0,r=!1,c=void 0;try{for(var u,d=i()(l);!(s=(u=d.next()).done);s=!0){var h=u.value,m=!0,p=!1,v=void 0;try{for(var f,b=i()(a);!(m=(f=b.next()).done);m=!0){var g=f.value;h.value==g&&o.push(h)}}catch(e){p=!0,v=e}finally{try{!m&&b.return&&b.return()}finally{if(p)throw v}}}}catch(e){r=!0,c=e}finally{try{!s&&d.return&&d.return()}finally{if(r)throw c}}var y=[];n.length<t&&(t=n.length);for(var _=e;_++;){var k={},w=!0,x=!1,T=void 0;try{for(var S,D=i()(a);!(w=(S=D.next()).done);w=!0){g=S.value;n[_].hasOwnProperty(g)&&this.$set(k,g,n[_][g])}}catch(e){x=!0,T=e}finally{try{!w&&D.return&&D.return()}finally{if(x)throw T}}y.push(k)}this.viewcolumns=o,this.viewtableData=y}else{this.viewcolumns=l;var C=[];n.length<t&&(t=n.length);for(_=e;_<t;_++){k=n[_];C.push(k)}this.viewtableData=C}},handleSelectionChange:function(e){this.multipleSelection=e},changeformColumnName:function(e){if(this.form.columnnameoptions){var t=!0,a=!1,l=void 0;try{for(var n,o=i()(this.form.columnnameoptions);!(t=(n=o.next()).done);t=!0){var s=n.value;s.Name==e&&(this.form.label=s.Desc,"INT"==s.DataType||"FLOAT"==s.DataType?this.isString=!1:this.isString=!0)}}catch(e){a=!0,l=e}finally{try{!t&&o.return&&o.return()}finally{if(a)throw l}}}},confirmUpdate:function(){this.columns;var e=this.form,t=(this.multipleSelection,this.form.columnnameoptions,e.columnname),a=e.value,l=e.radio,i=e.inputstep,n=e.inputcycle,o=[],s=0;for(var r in this.multipleSelection){var c={};c.id=this.multipleSelection[r].ID32,c.field=[],c.field.push(t);var u="";if("1"==l){var d=0;i&&(d=parseInt(r*i)),u=parseFloat(a)+d+""}else if("2"==l){d=0;i&&n&&(d=parseInt(s*i)+parseInt(n));var h=parseFloat(a)+d+"";h.split(".")[0][h.split(".")[0].length-1]<9&&h.length>1&&(s=0,i&&n&&(d=parseInt(s*i)+parseInt(n))),u=parseFloat(a)+d+""}else u=a;c.value=[],c.value.push(u),s++,o.push(c)}this.updateTablemodel(this.tableName,o),this.dialogUpdateVisible=!1},updateTablemodel:function(e,t){var a=this,l={tbname:e,records:t};a.$http.post(a.BASE_INFO.BASE_DATA_URL+"/updateRecordData",l).then(function(e){e&&e.data&&e.data.replyCode&&0==e.data.replyCode.code&&a.onselectclick()})},refresh:function(){var e=this;e.isrefresh=!e.isrefresh;var t=1e3*e.inputTime;e.isrefresh?(e.refreshInterval=setInterval(function(){e.onselectclick()},t),e.timeName="停止"):(e.refreshInterval=clearInterval(e.refreshInterval),e.timeName="刷新")},handleSizeChange:function(e){console.log("每页 "+e+" 条"),this.pagesize=e,this.onselectclick()},handleCurrentChange:function(e){console.log("当前页: "+e),this.currentpage=e,this.onselectclick()},getTreeData1:function(){this.$http.post(this.BASE_INFO.BASE_DEVICE_URL,{type:"get_model"}).then(function(e){console.dir(e)})}},components:{}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",[a("el-row",{attrs:{gutter:6}},[a("el-col",{attrs:{span:4}},[a("el-card",{staticStyle:{"background-color":"rgb(245,245,247)"},attrs:{shadow:"hover"}},[a("el-tree",{staticStyle:{"background-color":"rgb(245,245,247)"},attrs:{data:e.treeData,"node-key":"id","default-expanded-keys":e.idArr,"default-checked-keys":e.checkedkeys,"highlight-current":""},on:{"node-click":e.handleNodeClick}})],1)],1),e._v(" "),a("el-col",{attrs:{span:20}},[a("el-card",{attrs:{shadow:"hover"}},[a("el-tabs",{directives:[{name:"show",rawName:"v-show",value:e.addtabs,expression:"addtabs"}],attrs:{type:"card",closable:""},on:{"tab-click":e.onTabClick,"tab-remove":e.removeTab},model:{value:e.editableTabsValue,callback:function(t){e.editableTabsValue=t},expression:"editableTabsValue"}},e._l(e.editableTabs,function(t,l){return a("el-tab-pane",{key:t.name,attrs:{label:t.title,name:t.name}},[e._v("\n                            "+e._s(t.content)+"\n                        ")])})),e._v(" "),a("el-card",{directives:[{name:"show",rawName:"v-show",value:e.addtabs,expression:"addtabs"}],staticStyle:{"margin-bottom":"10px"},attrs:{shadow:"hover"}},[a("el-row",{staticStyle:{"margin-bottom":"10px"}},[a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("列选择")]),e._v(" "),a("el-button",{attrs:{type:"info",plain:""},on:{click:function(t){e.dialogUpdateVisible=!0}}},[e._v("修改信息")]),e._v(" "),a("el-input",{staticStyle:{width:"60px"},attrs:{placeholder:"5",type:"number",min:1},model:{value:e.inputTime,callback:function(t){e.inputTime=t},expression:"inputTime"}}),e._v(" "),a("el-button",{attrs:{type:"info",plain:""},on:{click:e.refresh}},[e._v(e._s(e.timeName))])],1),e._v(" "),a("el-row",{staticStyle:{"margin-bottom":"10px"}},[a("el-select",{attrs:{placeholder:"请选择列"},on:{change:e.changeColumnName},model:{value:e.columnname,callback:function(t){e.columnname=t},expression:"columnname"}},e._l(e.columnnameoptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.Desc,value:e.Name}})})),e._v(" "),a("el-select",{attrs:{placeholder:"等于"},model:{value:e.symbol,callback:function(t){e.symbol=t},expression:"symbol"}},e._l(e.symboloptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:""},model:{value:e.inputvalue,callback:function(t){e.inputvalue=t},expression:"inputvalue"}}),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.onselectclick}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"info",plain:""},on:{click:e.addcondition}},[e._v("增加条件")]),e._v(" "),a("el-button",{attrs:{type:"info",plain:""},on:{click:e.clearcondition}},[e._v("清空条件")])],1),e._v(" "),e._l(e.conditionList,function(t,l){return a("el-row",{key:l,staticStyle:{"margin-bottom":"10px"}},[a("el-select",{attrs:{placeholder:"请选择列"},on:{change:function(t){e.changeItemColumnName(t,l)}},model:{value:t.columnname,callback:function(a){e.$set(t,"columnname",a)},expression:"con.columnname"}},e._l(t.columnnameoptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.Desc,value:e.Name}})})),e._v(" "),a("el-select",{attrs:{placeholder:"等于"},model:{value:t.symbol,callback:function(a){e.$set(t,"symbol",a)},expression:"con.symbol"}},e._l(t.symboloptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:""},model:{value:t.inputvalue,callback:function(a){e.$set(t,"inputvalue",a)},expression:"con.inputvalue"}}),e._v(" "),a("i",{staticClass:"el-icon-close",attrs:{"``":""},on:{click:e.deletecondition}})],1)})],2)],1),e._v(" "),a("div",{staticClass:"block",staticStyle:{float:"right","margin-top":"20px","margin-bottom":"20px"}},[a("span",{staticClass:"demonstration"}),e._v(" "),a("el-pagination",{attrs:{"current-page":e.currentpage,"page-sizes":e.pagesizes,"page-size":e.pagesize,layout:"total,sizes, prev, pager, next, jumper",total:e.totalcount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("el-table",{attrs:{data:e.viewtableData,"header-cell-style":e.headercellstyle,border:""},on:{"selection-change":e.handleSelectionChange}},[e.addtabs?a("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),e._v(" "),e._l(e.viewcolumns,function(e,t){return a("el-table-column",{key:t,attrs:{label:e.label,prop:e.value,"min-width":"180"}})})],2),e._v(" "),a("div",{staticClass:"block",staticStyle:{float:"right","margin-top":"20px","margin-bottom":"20px"}},[a("span",{staticClass:"demonstration"}),e._v(" "),a("el-pagination",{attrs:{"current-page":e.currentpage,"page-sizes":e.pagesizes,"page-size":e.pagesize,layout:"total,sizes, prev, pager, next, jumper",total:e.totalcount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"列选择",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-transfer",{attrs:{titles:["所有列","已选择"],data:e.checkList},model:{value:e.checkvalue,callback:function(t){e.checkvalue=t},expression:"checkvalue"}}),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmCloumns}},[e._v("确 定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"修改信息",visible:e.dialogUpdateVisible},on:{"update:visible":function(t){e.dialogUpdateVisible=t}}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{label:"列名称","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"请选择列名称"},on:{change:e.changeformColumnName},model:{value:e.form.columnname,callback:function(t){e.$set(e.form,"columnname",t)},expression:"form.columnname"}},e._l(e.form.columnnameoptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.Desc,value:e.Name}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:e.form.label,disabled:e.isString,"label-width":e.formLabelWidth}},[a("el-input",{staticStyle:{width:"240px"},attrs:{disabled:e.isString,"auto-complete":"off",type:"number",min:0},model:{value:e.form.value,callback:function(t){e.$set(e.form,"value",t)},expression:"form.value"}})],1),e._v(" "),a("el-form-item",{staticStyle:{"font-weight":"bold"},attrs:{label:"增量模式","label-width":e.formLabelWidth}}),e._v(" "),a("el-form-item",{attrs:{label:"","label-width":e.formLabelWidth}},[a("el-radio-group",{model:{value:e.form.radio,callback:function(t){e.$set(e.form,"radio",t)},expression:"form.radio"}},[a("el-radio",{attrs:{label:1}},[e._v("按步长增长")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("按循环增长")])],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"","label-width":e.formLabelWidth}},[a("span",[e._v("步长")]),e._v(" "),a("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"",type:"number",min:0},model:{value:e.form.inputstep,callback:function(t){e.$set(e.form,"inputstep",t)},expression:"form.inputstep"}}),e._v(" "),a("span",[e._v("环长")]),e._v(" "),a("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:"",type:"number",min:0},model:{value:e.form.inputcycle,callback:function(t){e.$set(e.form,"inputcycle",t)},expression:"form.inputcycle"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogUpdateVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmUpdate}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var s=a("VU/8")(n,o,!1,function(e){a("tJ31")},null,null);t.default=s.exports}});