<!doctype html>
<html>
<head>
    <meta charset='utf-8'>
    <title>Report Sheet Viewer</title>
    <link rel="stylesheet" href="main/sheet/css/ui-bootstrap/jquery-ui.custom.css">
    <link rel="stylesheet" href="main/sheet/css/demo-style.css">
    <link rel="stylesheet" href="main/sheet/css/sheet-style.css">
    <link rel="stylesheet" href="main/handsontable/handsontable.full.css">
    <link rel="stylesheet" href="main/bootstrap/css/bootstrap-select.min.css">
    <link rel="stylesheet" href="main/bootstrap/css/bootstrap-colorpicker.min.css">
    <link rel="stylesheet" href="main/bootstrap/css/bootstrap.css">
    <link rel="stylesheet" href="main/printarea/css/ui-lightness/jquery-ui-1.10.4.custom.css" />
    <link rel="stylesheet" href="main/printarea/PrintArea.css" />

    <script type="text/javascript" src="main/sheet/js/jquery-3.2.1.js"></script>
    <script type="text/javascript" src="main/sheet/js/jquery-ui.custom.min.js"></script>
    <script type="text/javascript" src="main/sheet/js/numeral.sv-se.js"></script>
    <script type="text/javascript" src="main/handsontable/handsontable.full.js"></script>
    <script type="text/javascript" src="main/handsontable/languages/zh-CN.js"></script>
    <script type="text/javascript" src="main/bootstrap/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="main/bootstrap/js/bootstrap-colorpicker.min.js"></script>
    <script type="text/javascript" src="main/bootstrap/js/bootstrap-select.min.js"></script>
    <script type="text/javascript" src="main/sheet/js/report.js"></script>
    <script type="text/javascript" src="main/printarea/jquery-ui-1.10.4.custom.js"></script>
    <script type="text/JavaScript" src="main/printarea/jquery.PrintArea.js"> </script>
    <script type="text/JavaScript" src="main/SimuData.js"> </script>
    <script type="text/JavaScript" src="main/THPReport.js"> </script>
    <!-- <script type="text/JavaScript" src="main/mock/mock.js"> </script>  -->

    <script>

    </script>


</head>
<body>
<div id="tabs" style="position: absolute; vertical-align: middle;">
    <div id="tabs-header" style="position: relative;">
        <div style="float: left;">
            <label style="color: #337ab7;">选择报表：</label>
            <select id="mySheets" ></select>
            <label style="color: #337ab7;">选择时间：</label>
            <form id="searchForm">
	         <div class="row" >
	         	<div class="col-md-3">
	         		<div class="input-group input-inline-sm col-sm-12" >  
	         			<input type="hidden" name="timeType" id="timeType" value="1">
						<span class="input-group-addon" id="switchDay" onclick="javascript:switchDate(1);" style="background-color:#cccccc">日</span>  
						<span class="input-group-addon" id="switchMonth" onclick="javascript:switchDate(2);" >月</span>  
						<span class="input-group-addon" id="switchYear" onclick="javascript:switchDate(3);" >年</span>  
						<input type="hidden" name="startDateStr" id="timeMin">
						<input type="hidden" name="endDateStr" id="timeMax">
					</div>
	        	 </div>
				<div class="col-md-5" id="div1">  
					<div class="input-group input-inline-sm col-sm-12" >  
						<span class="input-group-addon " >时间</span>  
						<input type="text" class="form-control form_datetime"  readOnly id="timeMin1" onchange="changeTime(1)">  
						<span class="input-group-addon">至</span>  
						<input type="text" class="form-control form_datetime"   readOnly id="timeMax1" onchange="changeTime(2)">
					</div>
				</div>
				
				<div class="col-md-5" id="div2">  
					<div class="input-group input-inline-sm col-sm-12" >  
						<span class="input-group-addon " >时间</span>  
						<input type="text" class="form-control form_datetime2"  readOnly id="timeMin2" onchange="changeTime(3)">  
						<span class="input-group-addon">至</span>  
						<input type="text" class="form-control form_datetime2"   readOnly id="timeMax2" onchange="changeTime(4)">
					</div>
				</div>
				
				<div class="col-md-5" id="div3">  
					<div class="input-group input-inline-sm col-sm-12" >  
						<span class="input-group-addon " >时间</span>  
						<input type="text" class="form-control form_datetime3"  readOnly id="timeMin3" onchange="changeTime(5)">  
						<span class="input-group-addon">至</span>  
						<input type="text" class="form-control form_datetime3"   readOnly id="timeMax3" onchange="changeTime(6)">
					</div>
				</div>
				<div class="col-md-2">
					<button type="button" class="btn btn-success btn-sm" onclick="addData();">添加</button>
				    <button type="button" class="btn btn-primary btn-sm" onclick="search();">搜索</button>
				</div>
			</div>
		    </form>
            <input type="button" class="btn btn-success btn-sm" style="width:100px;height:30px;" onclick="viewSheet();" value="查  看"/>
            <input type="button" class="btn btn-primary btn-sm" style="width:100px;height:30px;" onclick="printSheet();" value="打  印"/>
            <input type="button" class="btn btn-primary btn-sm" style="width:100px;height:30px;" onclick="exportSheet();" value="导  出"/>
            <!--     -->
        </div>
    </div>
    
    <div id="tabs-body" style="clear:both;">
        <div id="dataTable"></div>
        <div id="myconsole"></div>
    </div>
</div>

<div class="modal fade" id="myOK" tabindex="-1" role="dialog" aria-labelledby="myOKLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
                <h4 class="modal-title" id="myOKLabel">成功</h4>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="txt_key">成功！</label>
                    <!--<input type="text" name="txt_key" class="form-control" id="txt_key" placeholder="编码">-->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span>确认</button>
            </div>
        </div>
    </div>
</div>

<script>
$(function(){
	$("#div1").show();
	$("#div2").hide();
	$("#div3").hide();
	$(".form_datetime").datetimepicker({
		language:  'zh-CN', 
		format: 'yyyy-mm-dd',//显示格式
		todayHighlight: 1,//今天高亮
		minView: "month",//设置只显示到月份
		startView:2,
		forceParse: 0,
		showMeridian: 1,
		autoclose: 1//选择后自动关闭
		});
	$(".form_datetime2").datetimepicker({
		language:  'zh-CN', 
		format: 'yyyy-mm',//显示格式
		todayHighlight: 1,//今天高亮
		minView: 3,//设置只显示到月份
		startView:4,
		forceParse: 0,
		showMeridian: 1,
		autoclose: 1//选择后自动关闭
		});
	$(".form_datetime3").datetimepicker({
		language:  'zh-CN', 
		format: 'yyyy',//显示格式
		todayHighlight: 1,//今天高亮
		minView: 4,//设置只显示到月份
		startView:4,
		forceParse: 0,
		showMeridian: 1,
		autoclose: 1//选择后自动关闭
		});
	
});


function changeTime(num){
	switch(num){
	case 1:$("#timeMin").val($("#timeMin1").val());break;
	case 2:$("#timeMax").val($("#timeMax1").val());break;
	case 3:$("#timeMin").val($("#timeMin2").val());break;
	case 4:$("#timeMax").val($("#timeMax2").val());break;
	case 5:$("#timeMin").val($("#timeMin3").val());break;
	case 6:$("#timeMax").val($("#timeMax3").val());break;
	}
}

function clearDate()
{
	$("#timeMin").val('');
	$("#timeMax").val('');
	$("#timeMin1").val('');
	$("#timeMax1").val('');
	$("#timeMin2").val('');
	$("#timeMax2").val('');
	$("#timeMin3").val('');
	$("#timeMax3").val('');
}

function switchDate(num){
	var switchDay= $("#switchDay");
	var switchMonth= $("#switchMonth");
	var switchYear= $("#switchYear");
	clearDate();
	$("#timeType").val(num);
	switch(num){
	case 1:
		switchDay.css("background-color","#cccccc");
		switchMonth.css("background-color","#ffffff");
		switchYear.css("background-color","#ffffff");
		$("#div1").show();
		$("#div2").hide();
		$("#div3").hide();
		break;
	case 2:
		switchDay.css("background-color","#ffffff");
		switchMonth.css("background-color","#cccccc");
		switchYear.css("background-color","#ffffff");
		$("#div1").hide();
		$("#div2").show();
		$("#div3").hide();
		break;
	case 3:
		switchDay.css("background-color","#ffffff");
		switchMonth.css("background-color","#ffffff");
		switchYear.css("background-color","#cccccc");
		$("#div1").hide();
		$("#div2").hide();
		$("#div3").show();
		break;
	}
	search();
}


</script>

</body>
</html>
